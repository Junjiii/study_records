# Thread

1. 프로그램
   윈도우의 exe 파일 혹은 Mac 의 dmg 파일과 같은 컴퓨터에서 실행가능한 파일을 통칭하는데
   단, 정확히는 아직 실행하지 않은 상태이기 때문에 정적 프로그램 (static program) 으로 프로그램은 코드의 덩어리 인 것이다.
2. 프로세스
   프로세스는 **실행 중인 프로그램**을 의미한다. 운영체제에 의해 ( 바이너리 )프로그램을 구동하면 독립적으로 실행되며 메모리에 공간을 할당 받고 CPU에서 실행/제어되어 메모리 상에서 이루어지는 “ 작업 단위 “를 프로세스라고 한다.

| 프로그램                                                     | 프로세스                                                             |
| ------------------------------------------------------------ | -------------------------------------------------------------------- |
| 어떤 작업을 하기 위해 실행할 수 있는 파일                    | 실행되어 작업 중인 프로그램                                          |
| 파일이 장치에는 있지만 메모리에 올라가 있지 않은 정적인 상태 | 메모리에 적재되고 CPU 자원을 할당 받아 프로그램이 실행되고 있는 상태 |
| 움직이지 않는 코드 덩어리                                    | 코드 덩어리를 실행 시킨 것                                           |

1.  스레드
    프로세스 내에서 동기에 진행되는 작업 갈래, “흐름(실행)의 단위” 를 말한다.
        ![스크린샷 2024-06-04 오후 6 51 30](https://github.com/Junjiii/study_records/assets/138355289/98182196-1ab1-479c-8d35-f6006feeee53)

일반적으로 프로세스는 하나 이상의 스레드를 갖고 프로세스를 생성하면 기본적으로 하나의 main 스레드가 생성되게 된다. 따라서 스레드가 늘어날수록 개발자가 직접 프로그래밍하여 위치 시켜주어야한다.

1.  프로세스 자원의 구조
    프로그램이 실행되어 프로세스가 만들어지면 4가지의 메모리 영역으로 구성되어 할당 받게 된다.
        ![스크린샷 2024-06-04 오후 6 56 02](https://github.com/Junjiii/study_records/assets/138355289/3995292c-f577-44a5-b05e-6cc31f9f3b15)

        - 코드영역 (text) : 작성한 프로그램 코드가 CPU가 해석 가능한 기계어 형태로 저장되어있다.
        - 데이터 영역 (data) : 코드가 실행되면서 사용하는 전역변수나 각종 데이터들이 모여있다. 데이터 영역은 .data / .rodata / .bss 영역으로 세분화 된다.
            - .data : 전역변수 또는 static 변수 등 프로그램이 사용하는 데이터를 저장
            - .Bss : 초기값 없는 전역 변수 , static 변수가 저장
            - .rodata : const 같은 상수 키워드 선언 된 변수나 문자열 상수사 저장
        - 스택 영역 (stack) : 지역 변수와 같은 호출한 함수가 종료되면 되돌아올 임시적인 자료를 저장하는 독립적인 공간이다. Stack 은 함수의 호출과 함께 할당되며, 함수의 호출이 완료되면 소멸한다. 만일 stack 영역을 초과하면 stack overflow 에러가 발생한다.
        - 힙 영역 (heap) : 생성자, 인스턴스와 같은 동적으로 할당되는 데이터들을 위해 존재하는 공간이다. 사용자에 의해 메모리 공간이 동적으로 할당되고 해제된다.

        text 영역과 data  영역은 선언할때 그 크기가 결정되는 정적 영역이지만 stack 영역과 heap 영역은 프로세스가 실행되는 동안 늘어나는 크기에 맞추는 동적인 영역이다.

   ![스크린샷 2024-06-04 오후 7 57 49](https://github.com/Junjiii/study_records/assets/138355289/fd0ddb04-2927-4ae5-9a53-82cdc5e85593)

   ( 프로세스 구조 )

   ![스크린샷 2024-06-04 오후 7 14 38](https://github.com/Junjiii/study_records/assets/138355289/3b2b6ad8-3d8e-4577-be24-43af449257fe)
2.  스레드의 자원 공유
    운영체제로부터 할당받은 메모리 자원 내에서 스레드가 여러개 있다면 동시에 여러 일을 할 수 있게 된다. 이것은 “스레드 끼리 프로세스의 자원을 공유” 하면서 실행되기 때문에 작업이 가능한 것이다.

   ![스크린샷 2024-06-04 오후 7 58 58](https://github.com/Junjiii/study_records/assets/138355289/e7420a9e-e197-4cbc-86b0-a0ed379f0b6b)

   ![스크린샷 2024-06-04 오후 8 02 21](https://github.com/Junjiii/study_records/assets/138355289/7eec96b1-612b-48df-ad37-d08a79f78a04)

        프로세스의 4가지 영역 중 stack 만 할당받아 복사하고 code, data, heap 은 프로세스 내 다른 스레드들과 공유된다. 따라서 각각의 스레드는 별도의 stack 을 가지지만 heap 메모리는 고유하기 때문에 서로 다른 스레드에서 가져와 읽고 쓰게 된다.
        이렇게 구성된 이유는 하나의 프로세스를 다수의 실행 단위인 스레드로 구분하여 자원을 공유하고 자원의 생성과 관리의 중복성을 최소화하여 수행 능력을 올리기 위해서다 .
